# –°—Ç—Ä–∞—Ç–µ–≥–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### üìù `.env` (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

- **–°—Ç–∞—Ç—É—Å**: –í `.gitignore`, –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—Å—è
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- **–°–æ–∑–¥–∞–Ω–∏–µ**: –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `.env.example`
- **–°–æ–¥–µ—Ä–∂–∏—Ç**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î, Redis, JWT —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è dev

```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥ —Å–≤–æ–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

### üß™ `.env.test` (E2E —Ç–µ—Å—Ç—ã)

- **–°—Ç–∞—Ç—É—Å**: **–ö–û–ú–ú–ò–¢–ò–¢–°–Ø –≤ Git**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: E2E —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ –∏ –≤ CI/CD
- **–°–æ–¥–µ—Ä–∂–∏—Ç**: –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ credentials (–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Ä–µ–ø–æ)
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: PostgreSQL —Å –ø—Ä–∞–≤–∞–º–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è CREATE/DROP DATABASE)

**–ü–æ—á–µ–º—É –∫–æ–º–º–∏—Ç–∏—Ç—Å—è?**

- –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–µ production —Å–µ–∫—Ä–µ—Ç—ã
- –ù—É–∂–µ–Ω –¥–ª—è GitHub Actions CI/CD
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**–õ–æ–∫–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**

```bash
# –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!)
cp .env.test .env.test.local
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env.test.local
```

### üöÄ `.env.prod` (Production)

- **–°—Ç–∞—Ç—É—Å**: –í `.gitignore`, **–ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Production —Å–µ—Ä–≤–µ—Ä
- **–°–æ–∑–¥–∞–Ω–∏–µ**: –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–∑ `.env.prod.template`
- **–°–æ–¥–µ—Ä–∂–∏—Ç**: **–†–µ–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã** (–ø–∞—Ä–æ–ª–∏ –ë–î, JWT –∫–ª—é—á–∏, API –∫–ª—é—á–∏)
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ß–µ—Ä–µ–∑ GitHub Secrets –≤ CI/CD

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**

- –ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env.prod` –≤ Git
- –í GitHub Actions –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è secret `ENV_PROD` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞
- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ `600` (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å)

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ GitHub Actions

### Test Job

–í CI —Ç–µ—Å—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:

1. –ò–∑ –∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–≥–æ `.env.test`
2. –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `env:` –≤ workflow (–¥–ª—è DATABASE_URL —Å service credentials)

```yaml
- name: üß™ E2E Tests
  run: yarn test:e2e:serial
  env:
    NODE_ENV: test
    DATABASE_URL: postgresql://test_user:test_pass@localhost:5432/books_test
    REDIS_HOST: localhost
```

### Deploy Job

Production credentials:

1. –•—Ä–∞–Ω—è—Ç—Å—è –≤ GitHub Secret: `ENV_PROD`
2. –°–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ SSH –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
3. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏

NestJS ConfigModule –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ (–ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ–±–µ–∂–¥–∞–µ—Ç):

1. `.env` (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. `.env.test` (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ setup-e2e.ts)
3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (`process.env`)
4. –í GitHub Actions: `env:` –∏–∑ workflow

## Best Practices

### ‚úÖ DO:

- –ö–æ–º–º–∏—Ç—å—Ç–µ `.env.test` —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ credentials
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.example` –∫–∞–∫ —à–∞–±–ª–æ–Ω –¥–ª—è `.env`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.prod.template` –∫–∞–∫ —à–∞–±–ª–æ–Ω –¥–ª—è `.env.prod`
- –•—Ä–∞–Ω–∏—Ç–µ production —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub Secrets
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.test.local` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π —Ç–µ—Å—Ç–æ–≤

### ‚ùå DON'T:

- –ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` (–ª–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è)
- –ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ `.env.prod` (**–ù–ò–ö–û–ì–î–ê!**)
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ production credentials –ª–æ–∫–∞–ª—å–Ω–æ
- –ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ API –∫–ª—é—á–∏ –≤ –∫–æ–º–º–∏—Ç–∞—Ö

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

```typescript
console.log('DATABASE_URL:', process.env.DATABASE_URL);
console.log('NODE_ENV:', process.env.NODE_ENV);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∫–æ–π —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω:

```bash
# –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
yarn start:dev

# –í —Ç–µ—Å—Ç–∞—Ö
yarn test:e2e

# –ö–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–∏–¥–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å
env | grep DATABASE_URL
```

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å `.env.test` –≤ `.gitignore`:

```bash
# 1. –£–¥–∞–ª–∏—Ç–µ –∏–∑ .gitignore
git rm --cached .env.test

# 2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–∞–º –Ω–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤
cat .env.test

# 3. –î–æ–±–∞–≤—å—Ç–µ –≤ Git
git add .env.test
git commit -m "feat: track .env.test for CI/CD compatibility"
```
