# –ü—Ä–æ–¥–∞–∫—à–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### `.env.prod` - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

- ‚úÖ –°–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- üîí –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: 600 (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å)
- üîë JWT —Å–µ–∫—Ä–µ—Ç—ã: –æ–±–Ω–æ–≤–ª–µ–Ω—ã, 44+ —Å–∏–º–≤–æ–ª–æ–≤
- üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `books_app` —Å —Å–∏–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º

### `docker-compose.prod.yml` - Docker Compose –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `.env.prod` —Ñ–∞–π–ª
- ü©∫ Healthcheck: `/api/metrics` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
- üê≥ Profile: `prod` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–∏—Å–æ–≤

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:

```bash
node check_prod_config.js
```

### –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

```bash
grep -E "(NODE_ENV|SWAGGER_ENABLED|RATE_LIMIT|TRUST_PROXY)" .env.prod
```

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ù–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å .env.prod –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp .env.prod deploy@server:/opt/books/app/src/.env.prod

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
chmod 600 /opt/books/app/src/.env.prod

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose -f docker-compose.prod.yml up -d
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker-compose.prod.yml ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ API –æ—Ç–≤–µ—á–∞–µ—Ç
curl -I http://localhost:5000/api/health/liveness

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Swagger –æ—Ç–∫–ª—é—á–µ–Ω (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 404)
curl -I http://localhost:5000/api

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose -f docker-compose.prod.yml logs -f app | head -20
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –í–∫–ª—é—á–µ–Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:

- Swagger –æ—Ç–∫–ª—é—á–µ–Ω (`SWAGGER_ENABLED=0`)
- Rate limiting –≤–∫–ª—é—á–µ–Ω (`RATE_LIMIT_GLOBAL_ENABLED=1`)
- Proxy trust –≤–∫–ª—é—á–µ–Ω (`TRUST_PROXY=1`)
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ JWT —Å–µ–∫—Ä–µ—Ç—ã (44+ —Å–∏–º–≤–æ–ª–æ–≤)
- CORS –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ–º–µ–Ω–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### ‚ö†Ô∏è TODO –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–≤:

- –û–±–Ω–æ–≤–∏—Ç—å `CORS_ORIGIN` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- –û–±–Ω–æ–≤–∏—Ç—å `LOCAL_PUBLIC_BASE_URL` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π API –¥–æ–º–µ–Ω
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ email –¥–ª—è `ADMIN_EMAILS`

## –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø

üöÄ **–ü—É–Ω–∫—Ç 7: Reverse Proxy / TLS**

- –ü–ª–∞–Ω: `docs/NEXT_STEPS_REVERSE_PROXY.md`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Caddy + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π HTTPS
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ `api.example.com` ‚Üí –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
