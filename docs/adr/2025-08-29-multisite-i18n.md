# ADR: Мультисайт i18n с префиксом пути `/:lang`

Дата: 2025-08-29

Статус: accepted

Контекст:

- Требуется строгая мультиязычность «мультисайт»: `mysite.com/en|fr|es|pt/...`.
- Язык публикации определяется префиксом пути, а не параметром `?lang`.

Решение:

- Вводим префикс `/:lang` для публичных маршрутов.
- Источник языка — префикс пути (приоритет над `?lang` и `Accept-Language`).
- `Page` переводим на уникальность `([language, slug])`.
- Книги/версии/SEO уже соответствуют модели per-language (через `BookVersion`).
- Таксономии локализуем через переводческие таблицы `CategoryTranslation` и `TagTranslation` (Variant B), поиск по `(language, slug)`.

Последствия:

- Потребуется миграция Prisma для `Page.slug` (см. MULTISITE_I18N.md).
- Обновить контроллеры/роутинг и E2E.
- Ввести Prisma‑модели переводов таксономий; обновить CRUD/публичные выдачи и e2e.

Альтернативы:

- Сохранять выбор языка через cookie/Accept-Language — не решает SEO/URL.
- Ввести отдельные базы/проекты на язык — избыточно для масштаба.

Ссылки:

- docs/MULTISITE_I18N.md — детальный план внедрения.
